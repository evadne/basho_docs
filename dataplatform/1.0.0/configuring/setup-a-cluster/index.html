<!DOCTYPE html>







<html class="no-js" lang="en">




<head>

  <meta charset="utf-8">
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
  <meta name="viewport" content="width=device-width">
  <link rel="shortcut icon" href="//evadne.github.io/basho_docs/images/branding/favicon.ico" type="image/x-icon" />

  <title>Setup a Basho Data Platform Cluster</title>

  <link href="//evadne.github.io/basho_docs/css/main.css" media="screen" rel="stylesheet" type="text/css">
  <link rel="canonical" href="//evadne.github.io/basho_docs/dataplatform/latest/configuring/setup-a-cluster/" />
  <!-- The below meta tags are included to allow JS code to use variables
       defined in Hugo---our static site generator. -->
  <meta name="project" content="dataplatform">
  <meta name="version" content="1.0.0">
  <meta name="project_relative_path" content="configuring/setup-a-cluster/">

</head>



<body class="dataplatform 1.0.0 latest ">


  <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-T9C8MK" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-T9C8MK');</script>


  
<header class="banner">



  
  <div class="float-right   banner__menu-bars   [bs] hidden-md-up">
    <div class="menu-bars   js_toggle-content-nav"></div>
  </div>



  
  <div class="float-left   banner__docs-logo">
    <a href="//evadne.github.io/basho_docs/index.html" class="block   docs-logo"><img class="docs-logo__image" src="//evadne.github.io/basho_docs/images/branding/basho_docs_logo.png"></a>
  </div>



  
  <div class="overflow-hidden   banner__navigation-pane   [bs] hidden-sm-down">


    
    <div class="float-left    banner__intra-brand__width-wrapper">
    <div class="float-right   banner__intra-brand">
      <div class="float-right">
        
        <a class="inline-block   banner__brand-link" href="http://basho.com/">Basho</a><a class="inline-block   banner__brand-link" href="https://academy.basho.com">Academy</a><a class="inline-block   banner__brand-link" href="//evadne.github.io/basho_docs/community">Community</a><a class="inline-block   banner__brand-link" href="http://basho.com/contact">Contact</a></div>
    </div>
    </div>




    
    <div class="float-left    banner__intra-site__width-wrapper">
    <div class="float-right   banner__intra-site">
      
      <a class="inline-block   banner__brand-link " href="//evadne.github.io/basho_docs/riak/kv/latest/">Riak KV</a><a class="inline-block   banner__brand-link " href="//evadne.github.io/basho_docs/riak/ts/latest/">Riak TS</a><a class="inline-block   banner__brand-link " href="//evadne.github.io/basho_docs/riak/cs/latest/">Riak CS</a></div>
    </div>


  </div>

</header>



  
  



<nav class="content-nav content-nav--top-size-full">




  <div class="content-nav__fixed-top">
    <form id="searchbox_011972015458788978446:zgdcy4fa-o0" class="search" action="">

      <span class="block float-left   search__icon-container   docs-icon--search">|</span>

      <span class="block overflow">
        <input class="search__input" id="main-search" type="search" name="q" placeholder="Search">
      </span>

    </form>


    <div class="clearfix   version-picker">

  

      <div class="inline-block float-right   selector selector--version">
        <header class="selector__title">Versions</header>
        <button class="selector__btn" type="button">1.0.0</button>
        <div    class="selector__arrow"></div>
      </div>

    </div>


  </div>


  
  <div class="overflow-y-hidden   selector-pane__sizing-box selector-pane__sizing-box--hidden">
  <div class="                    selector-pane__shadow-box">

    
    <div class="edge-fader edge-fader--left">
      <span class="inline-block   edge-fader__arrow edge-fader__arrow--invisible"></span>
    </div>
    <div class="edge-fader edge-fader--right">
      <span class="inline-block   edge-fader__arrow edge-fader__arrow--invisible"></span>
    </div>

    <div class="overflow-x        selector-pane__primary selector-pane--versions  js_edge-fader--target">
      
    </div>
  </div>
  </div>




  
  <div class="             content-nav__primary__sizing-box">
  <div class="             content-nav__primary__shadow-box">
  <div class="overflow-y   content-nav__primary">

    <div class="content-nav__menu-container">

      <ul class="content-menu
                 content-menu--depth-0
                 content-menu--open">


        <li >

          <div class="content-menu__item ">

            <span class="block float-left   content-menu__icon-container   docs-icon--riak">|</span>
            <span class="block float-right   content-menu__menu-toggle
                        ">
            </span>

            <a class="block overflow   content-menu__link--depth-0"  href="//evadne.github.io/basho_docs/dataplatform/1.0.0/" >
              <span class="block   content-menu__item__right-border"><strong>Basho Data Platform</strong></span>
            </a>

          </div>
          
          


<ul class="content-menu
           content-menu--depth-1
           "
    style="display: none">



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/dataplatform/1.0.0/downloads/" >
        <span class="block   content-menu__item__right-border">Download Basho Data Platform</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/dataplatform/1.0.0/installing/" >
        <span class="block   content-menu__item__right-border">Installing</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/dataplatform/1.0.0/upgrading/" >
        <span class="block   content-menu__item__right-border">Upgrading from Beta to 1.0.0</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/dataplatform/1.0.0/release-notes/" >
        <span class="block   content-menu__item__right-border">Release Notes</span>
      </a>

    </div>

  </li>



</ul>

        </li>


        <li >

          <div class="content-menu__item ">

            <span class="block float-left   content-menu__icon-container   docs-icon--configure">|</span>
            <span class="block float-right   content-menu__menu-toggle
                         content-menu__menu-toggle--open ">
            </span>

            <a class="block overflow   content-menu__link--depth-0"  href="//evadne.github.io/basho_docs/dataplatform/1.0.0/configuring/" >
              <span class="block   content-menu__item__right-border"><strong>Configuring</strong></span>
            </a>

          </div>
          
          


<ul class="content-menu
           content-menu--depth-1
           content-menu--open"
    style="display: block">



  <li>

    <div class="content-menu__item  content-menu__item--selected ">

      <a class="block overflow   content-menu__link--depth-1" >
        <span class="block   content-menu__item__right-border">Setup a Data Platform Cluster</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/dataplatform/1.0.0/configuring/replace-spark-cluster-manager/" >
        <span class="block   content-menu__item__right-border">Replacing Spark Cluster Manager</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/dataplatform/1.0.0/configuring/cache-proxy/" >
        <span class="block   content-menu__item__right-border">Getting Started with Cache Proxy</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/dataplatform/1.0.0/configuring/default-ports/" >
        <span class="block   content-menu__item__right-border">Default Ports</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/dataplatform/1.0.0/configuring/spark-ip-address/" >
        <span class="block   content-menu__item__right-border">Set Spark IP Address</span>
      </a>

    </div>

  </li>



</ul>

        </li>


        <li >

          <div class="content-menu__item ">

            <span class="block float-left   content-menu__icon-container   docs-icon--database">|</span>
            <span class="block float-right   content-menu__menu-toggle
                        ">
            </span>

            <a class="block overflow   content-menu__link--depth-0"  href="//evadne.github.io/basho_docs/dataplatform/1.0.0/using/" >
              <span class="block   content-menu__item__right-border"><strong>Using</strong></span>
            </a>

          </div>
          
          


<ul class="content-menu
           content-menu--depth-1
           "
    style="display: none">



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/dataplatform/1.0.0/using/start-services/" >
        <span class="block   content-menu__item__right-border">Start Services</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/dataplatform/1.0.0/using/spark-riak-connector/" >
        <span class="block   content-menu__item__right-border">Spark-Riak Connector</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/dataplatform/1.0.0/using/commands/" >
        <span class="block   content-menu__item__right-border">Data Platform Commands</span>
      </a>

    </div>

  </li>



</ul>

        </li>


        <li >

          <div class="content-menu__item ">

            <span class="block float-left   content-menu__icon-container   docs-icon--beaker">|</span>
            <span class="block float-right   content-menu__menu-toggle
                        ">
            </span>

            <a class="block overflow   content-menu__link--depth-0"  href="//evadne.github.io/basho_docs/dataplatform/1.0.0/learn/" >
              <span class="block   content-menu__item__right-border"><strong>Learn</strong></span>
            </a>

          </div>
          
          


<ul class="content-menu
           content-menu--depth-1
           "
    style="display: none">



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/dataplatform/1.0.0/learn/service-manager/" >
        <span class="block   content-menu__item__right-border">Service Manager</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/dataplatform/1.0.0/learn/cache-proxy/" >
        <span class="block   content-menu__item__right-border">Cache Proxy</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/dataplatform/1.0.0/learn/leader-election-service/" >
        <span class="block   content-menu__item__right-border">Leader Election Service</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/dataplatform/1.0.0/learn/spark-cluster-manager/" >
        <span class="block   content-menu__item__right-border">Spark Cluster Manager</span>
      </a>

    </div>

  </li>



</ul>

        </li>

        <li class="content-menu__blank-entry"></li>

      </ul>

    </div>



    <div class="content-nav__fixed-bottom">

      <ul class="content-menu">

        <li>
          <div class="content-menu__item">

            <span class="block float-left   content-menu__icon-container   docs-icon--comments">|</span>

            <a class="block overflow" href="//evadne.github.io/basho_docs/community">
              <span class="block   content-menu__item__right-border">
                <sub>Want some extra help?</sub><br>
                <strong>Ask our Community</strong>
              </span>
            </a>

          </div>
        </li>

        <li>
          <div class="content-menu__item">

            <span class="block float-left   content-menu__icon-container   docs-icon--question-sign">|</span>

            <a class="block overflow" href="http://basho.com/contact">
              <span class="block   content-menu__item__right-border">
                <sub>Need to chat?</sub><br>
                <strong>Contact us directly</strong>
              </span>
            </a>

          </div>
        </li>

        <li>
          <div class="content-menu__item">

            <span class="block float-left   content-menu__icon-container   docs-icon--github-alt">|</span>

            <a class="block overflow" href="https://github.com/basho/basho_docs/edit/master/content/dataplatform/1.0.0/configuring/setup-a-cluster.md">
              <span class="block   content-menu__item__right-border">
                <sub>Noticed a typo?</sub><br>
                <strong>Correct it in GitHub</strong>
              </span>
            </a>

          </div>
        </li>

      </ul>

    </div>

  </div>
  </div>
  </div>



</nav>

<script>
  (function() {
    var cx = '011972015458788978446:zgdcy4fa-o0';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<div style="width:0px;overflow:hidden;height:0px;">
  <gcse:search></gcse:search>
</div>






  <div class="content-well">


    <article class="main-article">


      

<header class="front-matter">


  <h1 class="front-matter__title">

    
    <br>
    Setup a Basho Data Platform Cluster

  </h1>
  <nav class="table-of-contents"></nav>


</header>


      <main>
        

<p>Now that you&rsquo;ve <a href="//evadne.github.io/basho_docs/dataplatform/1.0.0/installing/">installed Basho Data Platform</a>, you&rsquo;re ready to set up a Basho Data Platform (BDP) cluster. This page will guide you through this process.</p>

<p>This page also lists the default port connections for BDP.</p>

<h2 id="prerequisites">Prerequisites</h2>

<ul>
<li>We recommend running BDP on at least 5 nodes. Minimally, you will need 3 available, with BDP installed on all 3 nodes.</li>
<li>You must have basic Riak configuration parameters, including listen interfaces (<code>listen.protobuf.internal</code> and <code>listen.http.internal</code>) and nodename, configured before you begin. You can view a guide to the process <a href="//evadne.github.io/basho_docs/riak/kv/2.1.3/configuring/">here</a>.</li>
<li>You need to have joined the nodes you wish to run Riak KV on together before you continue. Check out <a href="//evadne.github.io/basho_docs/riak/kv/2.1.3/using/running-a-cluster/">Basic Cluster Setup</a>. (We strongly advise you not to join your Redis or Spark nodes to nodes that are part of your Riak KV cluster. Join them to your BDP cluster, instead.)</li>
<li>This document assumes you have basic knowledge of configuring and running Riak KV cluster. If not, please read our <a href="//evadne.github.io/basho_docs/riak/kv/2.1.3/">Riak KV documentation</a>.</li>
<li>You must have root access on the nodes in your cluster.</li>
<li>If you have a firewall, it should be configured to allow traffic for all network ports used by BDP. A list of default ports can be found <a href="//evadne.github.io/basho_docs/dataplatform/1.0.0/configuring/default-ports/">here</a>.</li>
<li>All of the steps in this guide assume you are working with your BDP nodes rather than any pre-existing Riak cluster.</li>
</ul>

<blockquote>
<p><strong>Note on Amazon Web Services</strong></p>

<p>AWS security profile must allow incoming and outgoing traffic from ip/ports used by Riak, Spark, and BDP. A list of default ports can be found <a href="//evadne.github.io/basho_docs/dataplatform/1.0.0/configuring/default-ports/">here</a>. Check out <a href="//evadne.github.io/basho_docs/riak/kv/2.1.3/setup/installing/amazon-web-services/">Installing on Amazon Web Services</a> for instructions on configuring security group settings to work with Riak.</p>
</blockquote>

<div class="warning">
  DO NOT join a BDP node to a pre-existing Riak cluster.
</div>

<h2 id="configure-a-bdp-cluster">Configure a BDP Cluster</h2>

<ol>
<li>First, start your BDP nodes.</li>
<li>Then, join your BDP nodes together.</li>
<li>Next, make sure riak_ensemble is running.</li>
<li>Then, configure the leader election service.</li>
<li>Next, if you&rsquo;re running a Spark cluster, set up your Spark cluster metadata.</li>
<li>After that, you&rsquo;ll need to confirm that Java is correctly configured.</li>
<li>Finally, add services to the nodes.</li>
</ol>

<h3 id="start-your-bdp-nodes">Start Your BDP Nodes</h3>

<p>First, start all the nodes you have installed BDP on:</p>

<pre><code class="language-bash">user@machine1:~$ sudo riak start
user@machine2:~$ sudo riak start
user@machine3:~$ sudo riak start
</code></pre>

<h3 id="join-bdp-nodes">Join BDP Nodes</h3>

<p>Then, join your BDP nodes together by running this command on all nodes in the cluster:</p>

<pre><code class="language-bash">user@machine2:~$ sudo data-platform-admin join »NODENAME, ie riak@IPADDRESS)« 
</code></pre>

<h3 id="check-riak-ensemble">Check <code>riak_ensemble</code></h3>

<p>Once your BDP nodes are started and joined together, make sure <a href="https://github.com/basho/riak_ensemble">riak_ensemble</a> has started.</p>

<div class="blocknote">
  
  <p>Basho Data Platform will not function correctly if <code>riak_ensemble</code> is not
running.</p>

</div>


<p>To check the status of <code>riak_ensemble</code>:</p>

<pre><code class="language-bash">sudo riak-admin ensemble-status
</code></pre>

<p>If <code>riak_ensemble</code> is enabled, you will see the following output :</p>

<pre><code>  ============================== Consensus System ==========================
  Enabled:     true
  Active:      true
  Ring Ready:  true
  Validation:  strong (trusted majority required)
  Metadata:    best-effort replication (asynchronous)
</code></pre>

<p>For more information on why this is important, please see our <a href="//evadne.github.io/basho_docs/riak/kv/2.1.3/using/reference/strong-consistency">strong consistency docs</a>.</p>

<h3 id="configure-the-leader-election-service-enterprise-edition-only">Configure The Leader Election Service (Enterprise Edition Only)</h3>

<blockquote>
<p>The following section is for Basho Data Platform Enterprise Edition. If you perform these steps in an open source version the Riak KV node under the BDP node will not start.</p>
</blockquote>

<p>Before enabling the leader election service, you must have enabled <code>riak_ensemble</code> (as directed in the previous step). If you skipped the previous step for any reason, please go back and do it now.</p>

<ol>
<li>Locate and open <code>riak.conf</code>.</li>
<li>Find the line <code>## listener.leader_latch.internal = 127.0.0.1:5323</code>.</li>
<li>Uncomment the line and set to your node&rsquo;s IP and port. (<strong>Note:</strong> Any port will work as long as it matches what you set in the Spark master step below.)</li>
</ol>

<div class="blocknote">
  
  <p>The leader election service provides no authentication mechanism. We strongly
suggest that you use a network shielded from external connection attempts,
otherwise you run the risk of an attacker performing a Denial of Service
attack against your cluster.</p>

</div>


<p>Add any additional interface/port pairs to listen on and change the &lsquo;.internal&rsquo; to whatever name helps you identify your interfaces. For instance:</p>

<pre><code class="language-riakconf">listener.leader_latch.internal = 127.0.0.1:5323
listener.leader_latch.external = 10.10.1.2:15323
listener.leader_latch.testing = 192.168.0.42:12345
</code></pre>

<div class="blocknote">
  
  <p>Changes to the <code>listener.leader_latch</code> setting will not have an impact on a
live running node. You must restart the node for changes to take effect.</p>

</div>


<h3 id="set-up-spark-cluster-metadata">Set Up Spark Cluster Metadata</h3>

<div class="blocknote">
  
  <p>Follow these steps ONLY if you are running a Spark cluster. Otherwise, skip to
Add Services.</p>

</div>


<p>If you are running a Spark cluster, you need to connect it with BDP.</p>

<p>First, set up a consistent bucket called &lsquo;spark-bucket&rsquo;  on your spark master node by running:</p>

<pre><code class="language-bash">sudo riak-admin bucket-type create strong '{&quot;props&quot;:{&quot;consistent&quot;:true}}'
</code></pre>

<p>Then enable the <code>map</code> bucket type by first running:</p>

<pre><code class="language-bash">sudo riak-admin bucket-type create maps '{&quot;props&quot;:{&quot;datatype&quot;:&quot;map&quot;}}'
</code></pre>

<p>Next activate the <code>map</code> bucket type by running:</p>

<pre><code>sudo riak-admin bucket-type activate maps
</code></pre>

<p>Finally, verify that the <code>map</code> bucket type was successfully set up by running:</p>

<pre><code class="language-bash">sudo riak-admin bucket-type status maps
</code></pre>

<p>A successful response should contain:</p>

<pre><code>maps is active
datatype: map
active: true
</code></pre>

<h3 id="confirm-java-home-is-set-correctly">Confirm <code>JAVA_HOME</code> Is Set Correctly</h3>

<p>If you are using Spark, you need to set <code>JAVA_HOME</code> for the &lsquo;riak&rsquo; user  on all the spark-master and spark-worker nodes. To confirm that it’s set correctly, run:</p>

<pre><code class="language-bash">sudo -u riak bash -c '$JAVA_HOME/bin/java -version'
</code></pre>

<p>The first line of output from that command should begin with <code>java version &quot;1.8…&quot;</code>. For example:</p>

<pre><code>java version &quot;1.8.0_45&quot;
Java(TM) SE Runtime Environment (build 1.8.0_45-b14)
Java HotSpot(TM) 64-Bit Server VM (build 25.45-b02, mixed mode)
</code></pre>

<p>If you are using Ubuntu, you need to preserve your environment when running data platform commands as a super user. To do this, add <code>JAVA_HOME</code> and append <code>$JAVA_HOME/bin</code> to <code>PATH</code> in /etc/environment.</p>

<pre><code class="language-bash">sudo vi /etc/sudoers
</code></pre>

<p>Add the following line: <code>Defaults        env_keep += &quot;JAVA_HOME&quot;</code></p>

<p>Then restart Riak</p>

<pre><code class="language-bash">sudo riak restart
</code></pre>

<h3 id="add-services">Add Services</h3>

<p>You are ready to add services to your started, joined BDP nodes. There are several different types of services you can add to your BDP nodes:</p>

<ul>
<li>Spark master</li>
<li>Spark worker</li>
<li>Redis</li>
<li>Cache proxy</li>
</ul>

<h4 id="spark-master">Spark Master</h4>

<blockquote>
<p>The Spark Master IP Address is selected automatically. If you need to set it manually, check out <a href="//evadne.github.io/basho_docs/dataplatform/1.0.0/configuring/spark-ip-address/">Set Spark IP Address</a>.</p>
</blockquote>

<p>To register the service configuration for Spark master, issue the following command:</p>

<pre><code class="language-bash">sudo data-platform-admin add-service-config my-spark-master spark-master LEAD_ELECT_SERVICE_HOSTS=&quot;»RIAK_IP_1:»LEADER_ELECTION_PORT«,»RIAK_IP_2«:»LEADER_ELECTION_PORT«&quot; RIAK_HOSTS=&quot;»RIAK_IP_1«:»RIAK_PB_PORT«,»RIAK_IP_2«:»RIAK_PB_PORT«&quot;
</code></pre>

<p>The IP addresses and ports you provide should be the IP addresses/ports of the 3 BDP nodes you started and joined earlier.</p>

<h4 id="spark-worker">Spark Worker</h4>

<p>To register the service configuration for Spark worker, issue the following command:</p>

<pre><code class="language-bash">sudo data-platform-admin add-service-config my-spark-worker spark-worker MASTER_URL=&quot;spark://»SPARK_MASTER_IP«:»SPARK_MASTER_PORT«&quot;
</code></pre>

<p>If you have multiple masters, list them after &lsquo;spark://&rsquo; as a comma-separated list of hostname:port entries (i.e. MASTER_URL=”spark://my-host-1:7077,my-host-2:7077”).</p>

<h4 id="redis">Redis</h4>

<p>To register the service configuration for Redis, issue the following command:</p>

<pre><code class="language-bash">sudo data-platform-admin add-service-config my-redis redis HOST=&quot;0.0.0.0&quot; REDIS_PORT=&quot;»REDIS_PORT«&quot;
</code></pre>

<h4 id="cache-proxy">Cache Proxy</h4>

<p>To register the service configuration for Cache Proxy, issue the following command:</p>

<pre><code class="language-bash">sudo data-platform-admin add-service-config my-cache-proxy cache-proxy  HOST=&quot;0.0.0.0&quot; CACHE_PROXY_PORT=&quot;»CACHE_PROXY_PORT«&quot; CACHE_PROXY_STATS_PORT=&quot;»CACHE_PROXY_STATS_PORT«&quot; CACHE_TTL=&quot;15s&quot; RIAK_KV_SERVERS=&quot;»RIAK_IP_1«:»RIAK_PB_PORT«,»RIAK_IP_2«:»RIAK_PB_PORT«&quot; REDIS_SERVERS=&quot;»REDIS_IP_1«:»REDIS_PORT«,»REDIS_IP_2«:»REDIS_PORT«&quot;
</code></pre>

<p>The IP addresses you provide should be the IP addresses of the 3 BDP nodes you started and joined earlier.</p>

<h2 id="configuration-defaults">Configuration Defaults</h2>

<p>Each service has one or more default ports if a port has not been specified when adding a service configuration.</p>

<p>For example, you can add a service configuration from the command line for Redis using a specified port:</p>

<pre><code class="language-bash">sudo data-platform-admin add-service-config my-redis redis HOST=&quot;0.0.0.0&quot; REDIS_PORT=&quot;»REDIS_PORT«&quot;
</code></pre>

<p>Or you can use the default port by leaving out the <code>REDIS_PORT</code> parameter:</p>

<pre><code>sudo data-platform-admin add-service-config my-redis redis HOST=&quot;0.0.0.0&quot;
</code></pre>

<p>In the above example, the Redis service will use the default port 6379.</p>

<h3 id="default-ports">Default Ports</h3>

<blockquote>
<p>If you&rsquo;re using AWS, be sure to check out <a href="//evadne.github.io/basho_docs/riak/kv/2.1.3/setup/installing/amazon-web-services/">Installing on Amazon Web Services</a> for instructions on configuring security group settings to work with Riak.</p>
</blockquote>

<p>If you have a firewall, it should be configured to allow traffic for all network ports used by BDP. A list of default ports can be found <a href="//evadne.github.io/basho_docs/dataplatform/1.0.0/configuring/default-ports/">here</a>.</p>

<h2 id="in-the-lab">In the Lab</h2>

<p>A vagrant BDP setup was developed to automate the validation of BDP packages, see <a href="https://github.com/basho-labs/vagrant-bdp-cluster/">basho-labs/vagrant-bdp-setup</a>.</p>

      </main>


    </article>


    <footer class="footer">

  <div class="inline-block   footer__attributions">

    <p>
      This work is licensed under a
      <br class="[bs] hidden-md-up">
      <a href="http://creativecommons.org/licenses/by/4.0/" target="_blank">
        Creative Commons Attribution 4.0 <br class="[bs] hidden-sm-up"> International Public License
      </a>
    </p>

    <p>
      © 2011-2017&nbsp;<a href="http://www.basho.com">Basho Technologies, Inc.</a>
    </p>

  </div>

</footer>



  </div>


  <script src="//evadne.github.io/basho_docs/js/main.js" type="text/javascript"></script>

</body>
</html>
