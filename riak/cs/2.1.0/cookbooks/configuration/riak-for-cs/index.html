<!DOCTYPE html>







<html class="no-js" lang="en">




<head>

  <meta charset="utf-8">
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
  <meta name="viewport" content="width=device-width">
  <link rel="shortcut icon" href="//evadne.github.io/basho_docs/images/branding/favicon.ico" type="image/x-icon" />

  <title>Configuring Riak KV for CS</title>

  <link href="//evadne.github.io/basho_docs/css/main.css" media="screen" rel="stylesheet" type="text/css">
  <link rel="canonical" href="//evadne.github.io/basho_docs/riak/cs/latest/cookbooks/configuration/riak-for-cs/" />
  <!-- The below meta tags are included to allow JS code to use variables
       defined in Hugo---our static site generator. -->
  <meta name="project" content="riak_cs">
  <meta name="version" content="2.1.0">
  <meta name="project_relative_path" content="cookbooks/configuration/riak-for-cs/">

</head>



<body class="riak_cs 2.1.0  ">


  <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-T9C8MK" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-T9C8MK');</script>


  
<header class="banner">



  
  <div class="float-right   banner__menu-bars   [bs] hidden-md-up">
    <div class="menu-bars   js_toggle-content-nav"></div>
  </div>



  
  <div class="float-left   banner__docs-logo">
    <a href="//evadne.github.io/basho_docs/index.html" class="block   docs-logo"><img class="docs-logo__image" src="//evadne.github.io/basho_docs/images/branding/basho_docs_logo.png"></a>
  </div>



  
  <div class="overflow-hidden   banner__navigation-pane   [bs] hidden-sm-down">


    
    <div class="float-left    banner__intra-brand__width-wrapper">
    <div class="float-right   banner__intra-brand">
      <div class="float-right">
        
        <a class="inline-block   banner__brand-link" href="http://basho.com/">Basho</a><a class="inline-block   banner__brand-link" href="https://academy.basho.com">Academy</a><a class="inline-block   banner__brand-link" href="//evadne.github.io/basho_docs/community">Community</a><a class="inline-block   banner__brand-link" href="http://basho.com/contact">Contact</a></div>
    </div>
    </div>




    
    <div class="float-left    banner__intra-site__width-wrapper">
    <div class="float-right   banner__intra-site">
      
      <a class="inline-block   banner__brand-link " href="//evadne.github.io/basho_docs/riak/kv/latest/">Riak KV</a><a class="inline-block   banner__brand-link " href="//evadne.github.io/basho_docs/riak/ts/latest/">Riak TS</a><a class="inline-block   banner__brand-link banner__brand-link--current">Riak CS</a></div>
    </div>


  </div>

</header>



  
  



<nav class="content-nav content-nav--top-size-full">




  <div class="content-nav__fixed-top">
    <form id="searchbox_011972015458788978446:zgdcy4fa-o0" class="search" action="">

      <span class="block float-left   search__icon-container   docs-icon--search">|</span>

      <span class="block overflow">
        <input class="search__input" id="main-search" type="search" name="q" placeholder="Search">
      </span>

    </form>


    <div class="clearfix   version-picker">

  
      <a class="inline-block float-left    product__title" href="//evadne.github.io/basho_docs/"><img class="product__logo" src="//evadne.github.io/basho_docs/images/branding/riak-logo.png">Riak<span class="product__title-highlight">CS</span>
      </a>
  

      <div class="inline-block float-right   selector selector--version">
        <header class="selector__title">Versions</header>
        <button class="selector__btn" type="button">2.1.0</button>
        <div    class="selector__arrow"></div>
      </div>

    </div>


  </div>


  
  <div class="overflow-y-hidden   selector-pane__sizing-box selector-pane__sizing-box--hidden">
  <div class="                    selector-pane__shadow-box">

    
    <div class="edge-fader edge-fader--left">
      <span class="inline-block   edge-fader__arrow edge-fader__arrow--invisible"></span>
    </div>
    <div class="edge-fader edge-fader--right">
      <span class="inline-block   edge-fader__arrow edge-fader__arrow--invisible"></span>
    </div>

    <div class="overflow-x        selector-pane__primary selector-pane--versions  js_edge-fader--target">
      
    </div>
  </div>
  </div>




  
  <div class="             content-nav__primary__sizing-box">
  <div class="             content-nav__primary__shadow-box">
  <div class="overflow-y   content-nav__primary">

    <div class="content-nav__menu-container">

      <ul class="content-menu
                 content-menu--depth-0
                 content-menu--open">


        <li >

          <div class="content-menu__item ">

            <span class="block float-left   content-menu__icon-container   docs-icon--bolt">|</span>
            <span class="block float-right   content-menu__menu-toggle
                        ">
            </span>

            <a class="block overflow   content-menu__link--depth-0"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/" >
              <span class="block   content-menu__item__right-border"><strong>Riak CS</strong></span>
            </a>

          </div>
          
          


<ul class="content-menu
           content-menu--depth-1
           "
    style="display: none">



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/downloads/" >
        <span class="block   content-menu__item__right-border">Download Riak CS</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/cookbooks/installing/" >
        <span class="block   content-menu__item__right-border">Installing Riak CS</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/cookbooks/installing/chef/" >
        <span class="block   content-menu__item__right-border">Installing With Chef</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">
      <span class="block float-right   content-menu__menu-toggle
                  ">
      </span>

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/tutorials/fast-track/" >
        <span class="block   content-menu__item__right-border">The Riak CS Fast Track</span>
      </a>

    </div>
    
    


<ul class="content-menu
           content-menu--depth-2
           "
    style="display: none">



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-2"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/tutorials/fast-track/what-is-riak-cs/" >
        <span class="block   content-menu__item__right-border">What Is Riak CS?</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-2"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/tutorials/fast-track/local-testing-environment/" >
        <span class="block   content-menu__item__right-border">Building a Local Test Environment</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-2"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/tutorials/fast-track/virtual-test-environment/" >
        <span class="block   content-menu__item__right-border">Building a Virtual Test Environment</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-2"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/tutorials/fast-track/test-installation/" >
        <span class="block   content-menu__item__right-border">Testing the Installation</span>
      </a>

    </div>

  </li>



</ul>

  </li>



</ul>

        </li>


        <li >

          <div class="content-menu__item ">

            <span class="block float-left   content-menu__icon-container   docs-icon--lambda">|</span>
            <span class="block float-right   content-menu__menu-toggle
                        ">
            </span>

            <a class="block overflow   content-menu__link--depth-0"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/developing/" >
              <span class="block   content-menu__item__right-border"><strong>Developing</strong></span>
            </a>

          </div>
          
          


<ul class="content-menu
           content-menu--depth-1
           "
    style="display: none">



  <li>

    <div class="content-menu__item ">
      <span class="block float-right   content-menu__menu-toggle
                  ">
      </span>

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/references/appendices/http-admin/" >
        <span class="block   content-menu__item__right-border">Accounts &amp; Admin</span>
      </a>

    </div>
    
    


<ul class="content-menu
           content-menu--depth-2
           "
    style="display: none">



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-2"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/cookbooks/account-management/" >
        <span class="block   content-menu__item__right-border">Account Management</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-2"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/cookbooks/access-control-lists/" >
        <span class="block   content-menu__item__right-border">Access Control Lists</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-2"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/cookbooks/authentication/" >
        <span class="block   content-menu__item__right-border">Authentication</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-2"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/cookbooks/usage-and-billing-data/" >
        <span class="block   content-menu__item__right-border">Usage and Billing Data</span>
      </a>

    </div>

  </li>



</ul>

  </li>



  <li>

    <div class="content-menu__item ">
      <span class="block float-right   content-menu__menu-toggle
                  ">
      </span>

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/references/apis/" >
        <span class="block   content-menu__item__right-border">APIs</span>
      </a>

    </div>
    
    


<ul class="content-menu
           content-menu--depth-2
           "
    style="display: none">



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-2"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/references/apis/storage/" >
        <span class="block   content-menu__item__right-border">Riak CS Storage API</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">
      <span class="block float-right   content-menu__menu-toggle
                  ">
      </span>

      <a class="block overflow   content-menu__link--depth-2"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/references/apis/storage/s3/" >
        <span class="block   content-menu__item__right-border">S3 API</span>
      </a>

    </div>
    
    


<ul class="content-menu
           content-menu--depth-3
           "
    style="display: none">



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-3"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/cookbooks/configuration/s3-client/" >
        <span class="block   content-menu__item__right-border">Configuring an S3 Client</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-3"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/cookbooks/fog/" >
        <span class="block   content-menu__item__right-border">Fog on Riak CS</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-3"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/cookbooks/configuration/dragondisk/" >
        <span class="block   content-menu__item__right-border">Configuring DragonDisk</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-3"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/cookbooks/configuration/transmit/" >
        <span class="block   content-menu__item__right-border">Configuring Transmit</span>
      </a>

    </div>

  </li>



</ul>

  </li>



  <li>

    <div class="content-menu__item ">
      <span class="block float-right   content-menu__menu-toggle
                  ">
      </span>

      <a class="block overflow   content-menu__link--depth-2"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/references/apis/storage/openstack/" >
        <span class="block   content-menu__item__right-border">OpenStack API</span>
      </a>

    </div>
    
    


<ul class="content-menu
           content-menu--depth-3
           "
    style="display: none">



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-3"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/cookbooks/using-with-keystone/" >
        <span class="block   content-menu__item__right-border">Using Riak CS With Keystone</span>
      </a>

    </div>

  </li>



</ul>

  </li>



</ul>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/cookbooks/querying-access-statistics/" >
        <span class="block   content-menu__item__right-border">Access Statistics</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/cookbooks/querying-storage-statistics/" >
        <span class="block   content-menu__item__right-border">Storage Statistics</span>
      </a>

    </div>

  </li>



</ul>

        </li>


        <li >

          <div class="content-menu__item ">

            <span class="block float-left   content-menu__icon-container   docs-icon--database">|</span>
            <span class="block float-right   content-menu__menu-toggle
                         content-menu__menu-toggle--open ">
            </span>

            <a class="block overflow   content-menu__link--depth-0"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/operating/" >
              <span class="block   content-menu__item__right-border"><strong>Operating</strong></span>
            </a>

          </div>
          
          


<ul class="content-menu
           content-menu--depth-1
           content-menu--open"
    style="display: block">



  <li>

    <div class="content-menu__item ">
      <span class="block float-right   content-menu__menu-toggle
                   content-menu__menu-toggle--open ">
      </span>

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/cookbooks/configuration/" >
        <span class="block   content-menu__item__right-border">Configuring</span>
      </a>

    </div>
    
    


<ul class="content-menu
           content-menu--depth-2
           content-menu--open"
    style="display: block">



  <li>

    <div class="content-menu__item  content-menu__item--selected ">

      <a class="block overflow   content-menu__link--depth-2" >
        <span class="block   content-menu__item__right-border">Configuring Riak KV for CS</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-2"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/cookbooks/configuration/riak-cs/" >
        <span class="block   content-menu__item__right-border">Configuring Riak CS</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-2"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/cookbooks/configuration/stanchion/" >
        <span class="block   content-menu__item__right-border">Configuring Stanchion</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-2"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/cookbooks/configuration/load-balancing-proxy/" >
        <span class="block   content-menu__item__right-border">Load Balancing &amp; Proxy Configuration</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-2"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/cookbooks/configuration/reference/" >
        <span class="block   content-menu__item__right-border">Configuration Reference</span>
      </a>

    </div>

  </li>



</ul>

  </li>



  <li>

    <div class="content-menu__item ">
      <span class="block float-right   content-menu__menu-toggle
                  ">
      </span>

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/operating/running/" >
        <span class="block   content-menu__item__right-border">Running</span>
      </a>

    </div>
    
    


<ul class="content-menu
           content-menu--depth-2
           "
    style="display: none">



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-2"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/cookbooks/command-line-tools/" >
        <span class="block   content-menu__item__right-border">Command-line Tools</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-2"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/cookbooks/installing/launching-and-stopping/" >
        <span class="block   content-menu__item__right-border">Launching and Stopping</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-2"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/cookbooks/logging/" >
        <span class="block   content-menu__item__right-border">Logging</span>
      </a>

    </div>

  </li>



</ul>

  </li>



  <li>

    <div class="content-menu__item ">
      <span class="block float-right   content-menu__menu-toggle
                  ">
      </span>

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/operating/advanced/" >
        <span class="block   content-menu__item__right-border">Advanced</span>
      </a>

    </div>
    
    


<ul class="content-menu
           content-menu--depth-2
           "
    style="display: none">



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-2"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/cookbooks/rolling-upgrades/" >
        <span class="block   content-menu__item__right-border">Rolling Upgrades</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-2"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/cookbooks/monitoring-and-metrics/" >
        <span class="block   content-menu__item__right-border">Monitoring &amp; Metrics</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-2"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/references/appendices/riak-cs-control/" >
        <span class="block   content-menu__item__right-border">Riak CS Control</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-2"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/cookbooks/supercluster/" >
        <span class="block   content-menu__item__right-border">Riak CS Supercluster Support</span>
      </a>

    </div>

  </li>



</ul>

  </li>



</ul>

        </li>


        <li >

          <div class="content-menu__item ">

            <span class="block float-left   content-menu__icon-container   docs-icon--beaker">|</span>
            <span class="block float-right   content-menu__menu-toggle
                        ">
            </span>

            <a class="block overflow   content-menu__link--depth-0"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/theory/" >
              <span class="block   content-menu__item__right-border"><strong>Theory &amp; Concepts</strong></span>
            </a>

          </div>
          
          


<ul class="content-menu
           content-menu--depth-1
           "
    style="display: none">



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/theory/stanchion/" >
        <span class="block   content-menu__item__right-border">Stanchion</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/cookbooks/multipart-upload-overview/" >
        <span class="block   content-menu__item__right-border">Multipart Upload Overview</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/cookbooks/garbage-collection/" >
        <span class="block   content-menu__item__right-border">Garbage Collection</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">
      <span class="block float-right   content-menu__menu-toggle
                  ">
      </span>

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/theory/comparisons/" >
        <span class="block   content-menu__item__right-border">Comparisons</span>
      </a>

    </div>
    
    


<ul class="content-menu
           content-menu--depth-2
           "
    style="display: none">



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-2"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/references/appendices/comparisons/swift/" >
        <span class="block   content-menu__item__right-border">Riak CS Compared To Swift</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-2"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/references/appendices/comparisons/atmos/" >
        <span class="block   content-menu__item__right-border">Riak CS Compared To Atmos</span>
      </a>

    </div>

  </li>



</ul>

  </li>



</ul>

        </li>


        <li >

          <div class="content-menu__item ">

            <span class="block float-left   content-menu__icon-container   docs-icon--references">|</span>
            <span class="block float-right   content-menu__menu-toggle
                        ">
            </span>

            <a class="block overflow   content-menu__link--depth-0"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/reference/" >
              <span class="block   content-menu__item__right-border"><strong>Reference</strong></span>
            </a>

          </div>
          
          


<ul class="content-menu
           content-menu--depth-1
           "
    style="display: none">



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/cookbooks/faqs/riak-cs/" >
        <span class="block   content-menu__item__right-border">FAQs</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/cookbooks/version-compatibility/" >
        <span class="block   content-menu__item__right-border">Version Compatibility</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/cookbooks/release-notes/" >
        <span class="block   content-menu__item__right-border">Riak CS Release Notes</span>
      </a>

    </div>

  </li>



</ul>

        </li>


        <li >

          <div class="content-menu__item ">

            <span class="block float-left   content-menu__icon-container   docs-icon--cloud">|</span>
            <span class="block float-right   content-menu__menu-toggle
                        ">
            </span>

            <a class="block overflow   content-menu__link--depth-0"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/cookbooks/multi-datacenter-overview/" >
              <span class="block   content-menu__item__right-border"><strong>Riak CS Enterprise</strong></span>
            </a>

          </div>
          
          


<ul class="content-menu
           content-menu--depth-1
           "
    style="display: none">



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/cs/2.1.0/cookbooks/configuration/multi-datacenter/" >
        <span class="block   content-menu__item__right-border">Configuring</span>
      </a>

    </div>

  </li>



</ul>

        </li>

        <li class="content-menu__blank-entry"></li>

      </ul>

    </div>



    <div class="content-nav__fixed-bottom">

      <ul class="content-menu">

        <li>
          <div class="content-menu__item">

            <span class="block float-left   content-menu__icon-container   docs-icon--comments">|</span>

            <a class="block overflow" href="//evadne.github.io/basho_docs/community">
              <span class="block   content-menu__item__right-border">
                <sub>Want some extra help?</sub><br>
                <strong>Ask our Community</strong>
              </span>
            </a>

          </div>
        </li>

        <li>
          <div class="content-menu__item">

            <span class="block float-left   content-menu__icon-container   docs-icon--question-sign">|</span>

            <a class="block overflow" href="http://basho.com/contact">
              <span class="block   content-menu__item__right-border">
                <sub>Need to chat?</sub><br>
                <strong>Contact us directly</strong>
              </span>
            </a>

          </div>
        </li>

        <li>
          <div class="content-menu__item">

            <span class="block float-left   content-menu__icon-container   docs-icon--github-alt">|</span>

            <a class="block overflow" href="https://github.com/basho/basho_docs/edit/master/content/riak/cs/2.1.0/cookbooks/configuration/riak-for-cs.md">
              <span class="block   content-menu__item__right-border">
                <sub>Noticed a typo?</sub><br>
                <strong>Correct it in GitHub</strong>
              </span>
            </a>

          </div>
        </li>

      </ul>

    </div>

  </div>
  </div>
  </div>



</nav>

<script>
  (function() {
    var cx = '011972015458788978446:zgdcy4fa-o0';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<div style="width:0px;overflow:hidden;height:0px;">
  <gcse:search></gcse:search>
</div>






  <div class="content-well">


    <article class="main-article">


      

<header class="front-matter">


  <h1 class="front-matter__title">

    
    <br>
    Configuring Riak KV for CS

  </h1>
  <nav class="table-of-contents"></nav>


</header>


      <main>
        

<p>Because Riak CS is an application built on top of Riak, it&rsquo;s important
to pay special attention to your Riak configuration when running Riak
CS. This document is both a tutorial on Riak configuration as well as a
reference document listing important configurable parameters.</p>

<h2 id="the-proper-backends-for-riak-cs">The Proper Backends for Riak CS</h2>

<p>The default backend used by Riak is the <a href="//evadne.github.io/basho_docs/riak/kv/2.1.3/setup/planning/backend/bitcask">Bitcask</a> backend, but the
Riak CS package includes a special backend that should be used by the
Riak cluster that is part of the Riak CS system. It is a custom version
of the standard <a href="//evadne.github.io/basho_docs/riak/kv/2.1.3/setup/planning/backend/multi">Multi</a> backend that ships with Riak.</p>

<p>Some of the Riak buckets used internally by Riak CS use secondary
indexes, which currently requires the <a href="//evadne.github.io/basho_docs/riak/kv/2.1.3/setup/planning/backend/leveldb">LevelDB</a> backend. Other parts
of the Riak CS system can benefit from the use of the Bitcask backend.
The use of the custom <a href="//evadne.github.io/basho_docs/riak/kv/2.1.3/setup/planning/backend/multi">Multi</a> backend enables Riak CS to take
advantage of the strengths of both of these backends to achieve the best
blend of performance and features. The next section covers how to
properly set up Riak to use this Multi backend.</p>

<p>Additionally, the Riak CS storage calculation system uses Riak&rsquo;s
<a href="//evadne.github.io/basho_docs/riak/kv/2.1.3/developing/usage/mapreduce">MapReduce</a> to sum the files in a bucket. This means that you must tell all of your Riak nodes where to find Riak CS&rsquo;s compiled files before calculating storage.</p>

<p>A few other settings must be modified to configure a Riak node as part
of a Riak CS system, such as the node IP address and the IP address and
port to use for communicating through Protocol Buffers. Other settings
can be modified if necessary. The following sections describe how to
configure a Riak node to work as part of a Riak CS system.</p>

<h2 id="setting-up-the-proper-riak-backend">Setting up the Proper Riak Backend</h2>

<p>First, edit Riak&rsquo;s <code>riak.conf</code>, or the old-style <code>advanced.config</code> or
<code>app.config</code> <a href="//evadne.github.io/basho_docs/riak/kv/2.1.3/configuring/reference">configuration file</a>. These files can be found in the <code>/etc/riak</code> or <code>/opt/riak/etc</code> directories. By default, Riak uses the <a href="//evadne.github.io/basho_docs/riak/kv/2.1.3/setup/planning/backend/bitcask">Bitcask</a> backend. The first thing we need to do is to change that by removing
the following line:</p>

<pre><code class="language-riakconf">## Delete this line:
storage_backend = bitcask
</code></pre>

<pre><code class="language-advancedconfig">{riak_kv, [
    %% Delete this line:
    {storage_backend, riak_kv_bitcask_backend},
]}
</code></pre>

<pre><code class="language-appconfig">{riak_kv, [
    %% Delete this line:
    {storage_backend, riak_kv_bitcask_backend},
]}
</code></pre>

<p>Next, we need to expose the necessary Riak CS modules to Riak and instruct Riak
to use the custom backend provided by Riak CS. We need to use either the
<code>advanced.config</code> or <code>app.config</code> file and insert the following options:</p>

<pre><code class="language-advancedconfig">{eleveldb, [
    {total_leveldb_mem_percent, 30}
    ]},
{riak_kv, [
    %% Other configs
    {add_paths, [&quot;/usr/lib/riak-cs/lib/riak_cs-2.1.0/ebin&quot;]},
    {storage_backend, riak_cs_kv_multi_backend},
    {multi_backend_prefix_list, [{&lt;&lt;&quot;0b:&quot;&gt;&gt;, be_blocks}]},
    {multi_backend_default, be_default},
    {multi_backend, [
        {be_default, riak_kv_eleveldb_backend, [
            {data_root, &quot;/var/lib/riak/leveldb&quot;}
        ]},
        {be_blocks, riak_kv_bitcask_backend, [
            {data_root, &quot;/var/lib/riak/bitcask&quot;}
        ]}
    ]},
    %% Other configs
]}
</code></pre>

<pre><code class="language-appconfig">{eleveldb, [
    {total_leveldb_mem_percent, 30}
    ]},
{riak_kv, [
    %% Other configs
    {add_paths, [&quot;/usr/lib/riak-cs/lib/riak_cs-2.1.0/ebin&quot;]},
    {storage_backend, riak_cs_kv_multi_backend},
    {multi_backend_prefix_list, [{&lt;&lt;&quot;0b:&quot;&gt;&gt;, be_blocks}]},
    {multi_backend_default, be_default},
    {multi_backend, [
        {be_default, riak_kv_eleveldb_backend, [
            {data_root, &quot;/var/lib/riak/leveldb&quot;}
        ]},
        {be_blocks, riak_kv_bitcask_backend, [
            {data_root, &quot;/var/lib/riak/bitcask&quot;}
        ]}
    ]},
    %% Other configs
]}
</code></pre>

<p>It&rsquo;s important to note that many of these values will depend on various
directories specific to your <a href="//evadne.github.io/basho_docs/riak/kv/2.1.3/setup/installing">operating system</a>, so make sure to adjust them accordingly. The <code>add_paths</code>
parameter, for example, assumes that Riak CS is installed in
<code>/usr/lib/riak-cs</code>, while the <code>data_root</code> parameters assume that Riak is
installed in <code>/var/lib/</code>.</p>

<p>This configuration also assumes that the Riak CS package is installed on
the same machine as Riak. If not, the package will need to be copied
onto the same box.</p>

<h2 id="allowing-for-sibling-creation">Allowing for Sibling Creation</h2>

<p>Now, we need to set the <code>allow_mult</code> parameter to <code>true</code>. We can add this line
to the either the <code>riak.conf</code> configuration file, or to the <code>riak_core</code> section
of old-style <code>advanced.config</code> or <code>app.config</code> files:</p>

<pre><code class="language-riakconf">buckets.default.allow_mult = true
</code></pre>

<pre><code class="language-advancedconfig">{riak_core, [
    %% Other configs
    {default_bucket_props, [{allow_mult, true}]},
    %% Other configs
]}
</code></pre>

<pre><code class="language-appconfig">{riak_core, [
    %% Other configs
    {default_bucket_props, [{allow_mult, true}]},
    %% Other configs
]}
</code></pre>

<p>This will enable Riak to create <a href="//evadne.github.io/basho_docs/riak/kv/2.1.3/learn/concepts/causal-context/#siblings">siblings</a>, which is necessary for Riak CS to function. If you are connecting to Riak CS from a <a href="//evadne.github.io/basho_docs/riak/kv/2.1.3/developing/client-libraries">client library</a>, don&rsquo;t worry: you will not have to manage <a href="//evadne.github.io/basho_docs/riak/kv/2.1.3/developing/usage/conflict-resolution">conflict resolution</a>, as all Riak CS
operations are strongly consistent by definition.</p>

<div class="blocknote">
  
    <div class="blocknote__title">Note on <code>allow_mult</code></div>
  
  <p>Any Riak node that also supports Riak CS should have <code>allow_mult</code> set to
<code>true</code> at all times. Riak CS will refuse to start if <code>allow_mult</code> is set to
<code>false</code>.</p>

</div>


<h2 id="specifying-the-nodename-and-ip-address">Specifying the Nodename and IP Address</h2>

<p>Every Riak node has a name that can be specified in <code>riak.conf</code> using the
<code>nodename</code> option. If you are using the old-style <code>app.config</code> configuration
file, you will need to create a file named <code>vm.args</code> in the same directory as
the <code>app.config</code> file, and set the node name using the <code>-name</code> flag. We
recommend providing nodes a name of the form <code>&lt;name&gt;@&lt;host&gt;</code>. So if you have
three nodes running on the host <code>100.0.0.1</code>, you could name them
<code>riak1@100.0.0.1</code>, <code>riak2@100.0.0.1</code>, and <code>riak3@100.0.0.1</code>, or you could give
them names that are more specific, such as <code>test_cluster1@100.0.0.1</code>,
<code>user_data3@100.0.0.1</code>, and so on. The example below demonstrates changing a
node&rsquo;s name to <code>riak1@127.0.0.1</code>, which would work for a node running on
<code>localhost</code>:</p>

<pre><code class="language-riakconf">nodename = riak1@127.0.0.1
</code></pre>

<pre><code class="language-vmargs">-name riak1@127.0.0.1
</code></pre>

<p>You should name <em>all</em> nodes prior to starting them and connecting them
to a cluster.</p>

<h2 id="testing-the-configuration">Testing the Configuration</h2>

<p>Now that the necessary changes have been made to the Riak node&rsquo;s configuration,
we can attempt to start Riak:</p>

<pre><code class="language-bash">riak start
</code></pre>

<p>This could take a second. We can then test whether the node is running:</p>

<pre><code class="language-bash">riak ping
</code></pre>

<p>If the response is <code>pong</code>, then Riak is running; if the response is
<code>Node not responding to pings</code>, then something has gone wrong.</p>

<p>If the node has not started properly, look at the <code>erlang.log.1</code> in the
<code>/log</code> directory of the node to see if the problem can be identified.
One common error is <code>invalid_storage_backend</code>, which indicates that the
path to the Riak CS library in <code>advanced.config</code> or in <code>app.config</code> is incorrect
(or that Riak CS is not installed on the server). In spite of this error, make
sure that you do not change the backend from <code>riak_cs_kv_multi_backend</code> to
<code>riak_kv_multi_backend</code>.</p>

<h2 id="setting-up-riak-to-use-protocol-buffers">Setting Up Riak to Use Protocol Buffers</h2>

<p>The Riak <a href="//evadne.github.io/basho_docs/riak/kv/2.1.3/developing/api/protocol-buffers">Protocol Buffers</a> settings reside in the Riak <code>riak.conf</code>,
or in the <code>riak_api</code> section of the the old-style <code>advanced.config</code> or
<code>app.config</code> files, which is located in the <code>/etc/riak/</code> folder. The default host
is <code>127.0.0.1</code> and the default port is <code>8087</code>. You will need to change this if
you plan on running Riak and Riak CS in a non-local environment. Replace
<code>127.0.0.1</code> with the IP address of the Riak node and <code>8087</code> with the appropriate
port:</p>

<pre><code class="language-riakconf">listener.protobuf.internal = 10.0.2.10:10001
</code></pre>

<pre><code class="language-advancedconfig">{riak_api, [
    %% Other configs
    {pb, [&quot;10.0.2.10&quot;, 10001]},
    %% Other configs
]}
</code></pre>

<pre><code class="language-appconfig">{riak_api, [
    %% Other configs
    {pb, [&quot;10.0.2.10&quot;, 10001]},
    %% Other configs
]}
</code></pre>

<p><strong>Note</strong>: The <code>listener.protobuf.internal</code> values in the Riak <code>riak.conf</code> (or
the <code>pb</code> value in <code>advanced.config</code>/<code>app.config</code>) file must match the values for
<code>riak_host</code> in the Riak CS <code>riak-cs.config</code> and Stanchion <code>stanchion.conf</code> (or
<code>riak_host</code> the relative <code>advanced.config</code>/<code>app.config</code>) files.</p>

<div class="blocknote">
  
    <div class="blocknote__title">Note on port numbers</div>
  
  <p>A different port number might be required if the port number conflicts with
ports used by another application or if you use a load balancer or proxy
server.</p>

</div>


<p>It is also recommended that users insure that the size of Riak&rsquo;s
<code>protobuf.backlog</code> (or in the <code>advanced.config</code>/<code>app.config</code> files, the
<code>pb_backlog</code>) is equal to or greater than the size of the
<code>pool.request.size</code>, specified in the Riak CS <code>riak-cs.conf</code> (or
the <code>request_pool</code> size in the <code>advanced.config</code>/<code>app.config</code> files).</p>

<p>If the <code>pool.request.size</code> value in Riak CS is changed, the <code>protobuf.backlog</code>
value in Riak should be updated as well.</p>

<h2 id="other-riak-settings">Other Riak Settings</h2>

<p>The <code>riak.conf</code> and <code>advanced.config</code> files includes other settings, such as
turning on the creation of log files and specifying where to store them. These
settings have default values that should work in most cases. For more
information, we recommend reading our <a href="http://docs.basho.com/riak/2.0.5/ops/advanced/configs/configuration-files/">configuration files</a>
documentation.</p>

<h2 id="specifying-the-riak-ip-address">Specifying the Riak IP Address</h2>

<p>By setting the Riak IP address you ensure that your Riak nodes have unique IP
addresses, whether you&rsquo;re working with a single node or adding additional nodes
to the system. The Riak IP address setting resides in the Riak <code>riak.conf</code> or
&ndash; if you&rsquo;re using the <code>app.config</code> file &ndash; in the <code>vm.args</code> configuration file,
which is located in the same <code>/etc/riak/</code> directory (or in <code>/opt/riak/etc/</code> on
some operating systems).</p>

<p>Initially, the line that specifies the riak node IP address is set to the local
host, as follows:</p>

<pre><code class="language-riakconf">nodename = riak@127.0.0.1
</code></pre>

<pre><code class="language-vmargs">-name riak@127.0.0.1
</code></pre>

<p>Replace <code>127.0.0.1</code> with the appropriate IP address or hostname for the Riak
node.</p>

<h3 id="performance-and-capacity-settings">Performance and Capacity settings</h3>

<p>For performance reasons, we strongly recommended that you insert the following
values into Riak&rsquo;s <code>riak.conf</code>, or the old-style <code>vm.args</code>, configuration file,
located in the <code>/etc/riak</code> or <code>/opt/riak/etc</code> folder:</p>

<pre><code class="language-riakconf">erlang.max_ports = 65536
</code></pre>

<pre><code class="language-vmargs">## This setting should already be present for recent Riak installs.
-env ERL_MAX_PORTS 65536
</code></pre>

<h3 id="disable-javascript-mapreduce">Disable JavaScript MapReduce</h3>

<p>It is recommended that you not use the now-deprecated JavaScript MapReduce in
conjunction with <em>any</em> version of Riak CS. For performance reasons, you should
disable the VM that performs JavaScript MapReduce operations by setting the
following in the <code>riak.conf</code> configuration file, or the <code>riak_kv</code> section of the
old-style <code>advanced.config</code> or <code>app.config</code>:</p>

<pre><code class="language-riakconf">javascript.map_pool_size = 0
javascript.reduce_pool_size = 0
javascript.hook_pool_size = 0
</code></pre>

<pre><code class="language-advancedconfig">{riak_kv, [
    %% Other configs
    {map_js_vm_count, 0},
    {reduce_js_vm_count, 0},
    {hook_js_vm_count, 0}
    %% Other configs
]}
</code></pre>

<pre><code class="language-appconfig">{riak_kv, [
    %% Other configs
    {map_js_vm_count, 0},
    {reduce_js_vm_count, 0},
    {hook_js_vm_count, 0}
    %% Other configs
]}
</code></pre>

      </main>


    </article>


    <footer class="footer">

  <div class="inline-block   footer__attributions">

    <p>
      This work is licensed under a
      <br class="[bs] hidden-md-up">
      <a href="http://creativecommons.org/licenses/by/4.0/" target="_blank">
        Creative Commons Attribution 4.0 <br class="[bs] hidden-sm-up"> International Public License
      </a>
    </p>

    <p>
      Â© 2011-2017&nbsp;<a href="http://www.basho.com">Basho Technologies, Inc.</a>
    </p>

  </div>

</footer>



  </div>


  <script src="//evadne.github.io/basho_docs/js/main.js" type="text/javascript"></script>

</body>
</html>
