<!DOCTYPE html>







<html class="no-js" lang="en">




<head>

  <meta charset="utf-8">
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
  <meta name="viewport" content="width=device-width">
  <link rel="shortcut icon" href="//evadne.github.io/basho_docs/images/branding/favicon.ico" type="image/x-icon" />

  <title>Architecture of Riak TS Tables</title>

  <link href="//evadne.github.io/basho_docs/css/main.css" media="screen" rel="stylesheet" type="text/css">
  <link rel="canonical" href="//evadne.github.io/basho_docs/riak/ts/latest/learn-about/tablearchitecture/" />
  <!-- The below meta tags are included to allow JS code to use variables
       defined in Hugo---our static site generator. -->
  <meta name="project" content="riak_ts">
  <meta name="version" content="1.3.1">
  <meta name="project_relative_path" content="learn-about/tablearchitecture/">

</head>



<body class="riak_ts 1.3.1  ">


  <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-T9C8MK" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-T9C8MK');</script>


  
<header class="banner">



  
  <div class="float-right   banner__menu-bars   [bs] hidden-md-up">
    <div class="menu-bars   js_toggle-content-nav"></div>
  </div>



  
  <div class="float-left   banner__docs-logo">
    <a href="//evadne.github.io/basho_docs/index.html" class="block   docs-logo"><img class="docs-logo__image" src="//evadne.github.io/basho_docs/images/branding/basho_docs_logo.png"></a>
  </div>



  
  <div class="overflow-hidden   banner__navigation-pane   [bs] hidden-sm-down">


    
    <div class="float-left    banner__intra-brand__width-wrapper">
    <div class="float-right   banner__intra-brand">
      <div class="float-right">
        
        <a class="inline-block   banner__brand-link" href="http://basho.com/">Basho</a><a class="inline-block   banner__brand-link" href="https://academy.basho.com">Academy</a><a class="inline-block   banner__brand-link" href="//evadne.github.io/basho_docs/community">Community</a><a class="inline-block   banner__brand-link" href="http://basho.com/contact">Contact</a></div>
    </div>
    </div>




    
    <div class="float-left    banner__intra-site__width-wrapper">
    <div class="float-right   banner__intra-site">
      
      <a class="inline-block   banner__brand-link " href="//evadne.github.io/basho_docs/riak/kv/latest/">Riak KV</a><a class="inline-block   banner__brand-link banner__brand-link--current">Riak TS</a><a class="inline-block   banner__brand-link " href="//evadne.github.io/basho_docs/riak/cs/latest/">Riak CS</a></div>
    </div>


  </div>

</header>



  
  



<nav class="content-nav content-nav--top-size-full">




  <div class="content-nav__fixed-top">
    <form id="searchbox_011972015458788978446:zgdcy4fa-o0" class="search" action="">

      <span class="block float-left   search__icon-container   docs-icon--search">|</span>

      <span class="block overflow">
        <input class="search__input" id="main-search" type="search" name="q" placeholder="Search">
      </span>

    </form>


    <div class="clearfix   version-picker">

  
      <a class="inline-block float-left    product__title" href="//evadne.github.io/basho_docs/"><img class="product__logo" src="//evadne.github.io/basho_docs/images/branding/riak-logo.png">Riak<span class="product__title-highlight">TS</span>
      </a>
  

      <div class="inline-block float-right   selector selector--version">
        <header class="selector__title">Versions</header>
        <button class="selector__btn" type="button">1.3.1</button>
        <div    class="selector__arrow"></div>
      </div>

    </div>


  </div>


  
  <div class="overflow-y-hidden   selector-pane__sizing-box selector-pane__sizing-box--hidden">
  <div class="                    selector-pane__shadow-box">

    
    <div class="edge-fader edge-fader--left">
      <span class="inline-block   edge-fader__arrow edge-fader__arrow--invisible"></span>
    </div>
    <div class="edge-fader edge-fader--right">
      <span class="inline-block   edge-fader__arrow edge-fader__arrow--invisible"></span>
    </div>

    <div class="overflow-x        selector-pane__primary selector-pane--versions  js_edge-fader--target">
      
    </div>
  </div>
  </div>




  
  <div class="             content-nav__primary__sizing-box">
  <div class="             content-nav__primary__shadow-box">
  <div class="overflow-y   content-nav__primary">

    <div class="content-nav__menu-container">

      <ul class="content-menu
                 content-menu--depth-0
                 content-menu--open">


        <li >

          <div class="content-menu__item ">

            <span class="block float-left   content-menu__icon-container   docs-icon--riak">|</span>
            <span class="block float-right   content-menu__menu-toggle
                        ">
            </span>

            <a class="block overflow   content-menu__link--depth-0"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/" >
              <span class="block   content-menu__item__right-border"><strong>Riak TS</strong></span>
            </a>

          </div>
          
          


<ul class="content-menu
           content-menu--depth-1
           "
    style="display: none">



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/releasenotes/" >
        <span class="block   content-menu__item__right-border">Release Notes</span>
      </a>

    </div>

  </li>



</ul>

        </li>


        <li class="content-menu__download-entry">

          <div class="content-menu__item ">

            <span class="block float-left   content-menu__icon-container   docs-icon--download-alt">|</span>

            <a class="block overflow   content-menu__link--depth-0"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/downloads/" >
              <span class="block   content-menu__item__right-border"><strong>Download Riak TS</strong></span>
            </a>

          </div>

        </li>


        <li >

          <div class="content-menu__item ">

            <span class="block float-left   content-menu__icon-container   docs-icon--install">|</span>
            <span class="block float-right   content-menu__menu-toggle
                        ">
            </span>

            <a class="block overflow   content-menu__link--depth-0"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/installing/" >
              <span class="block   content-menu__item__right-border"><strong>Install</strong></span>
            </a>

          </div>
          
          


<ul class="content-menu
           content-menu--depth-1
           "
    style="display: none">



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/installing/debian-ubuntu/" >
        <span class="block   content-menu__item__right-border">Debian and Ubuntu</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/installing/mac-osx/" >
        <span class="block   content-menu__item__right-border">Mac OS X</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/installing/rhel-centos/" >
        <span class="block   content-menu__item__right-border">CentOS/RHEL</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/installing/aws/" >
        <span class="block   content-menu__item__right-border">AWS Marketplace</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">
      <span class="block float-right   content-menu__menu-toggle
                  ">
      </span>

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/installing/source/" >
        <span class="block   content-menu__item__right-border">Source</span>
      </a>

    </div>
    
    


<ul class="content-menu
           content-menu--depth-2
           "
    style="display: none">



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-2"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/installing/source/erlang/" >
        <span class="block   content-menu__item__right-border">Erlang</span>
      </a>

    </div>

  </li>



</ul>

  </li>



</ul>

        </li>


        <li >

          <div class="content-menu__item ">

            <span class="block float-left   content-menu__icon-container   docs-icon--database">|</span>
            <span class="block float-right   content-menu__menu-toggle
                        ">
            </span>

            <a class="block overflow   content-menu__link--depth-0"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/using/" >
              <span class="block   content-menu__item__right-border"><strong>Use</strong></span>
            </a>

          </div>
          
          


<ul class="content-menu
           content-menu--depth-1
           "
    style="display: none">



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/using/planning/" >
        <span class="block   content-menu__item__right-border">Plan Your Table</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/using/creating-activating/" >
        <span class="block   content-menu__item__right-border">Create and Activate Your Table</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/using/writingdata/" >
        <span class="block   content-menu__item__right-border">Write Data</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/using/querying/" >
        <span class="block   content-menu__item__right-border">Query Data</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/using/configuring/" >
        <span class="block   content-menu__item__right-border">Configure</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/using/mdc/" >
        <span class="block   content-menu__item__right-border">MDC</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/using/aggregate-functions/" >
        <span class="block   content-menu__item__right-border">Aggregate Functions</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/using/arithmetic-operations/" >
        <span class="block   content-menu__item__right-border">Arithmetic Operations</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/using/riakshell/" >
        <span class="block   content-menu__item__right-border">riak shell</span>
      </a>

    </div>

  </li>



</ul>

        </li>


        <li >

          <div class="content-menu__item ">

            <span class="block float-left   content-menu__icon-container   docs-icon--lambda">|</span>
            <span class="block float-right   content-menu__menu-toggle
                        ">
            </span>

            <a class="block overflow   content-menu__link--depth-0"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/developing/" >
              <span class="block   content-menu__item__right-border"><strong>Develop</strong></span>
            </a>

          </div>
          
          


<ul class="content-menu
           content-menu--depth-1
           "
    style="display: none">



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/developing/csharp/" >
        <span class="block   content-menu__item__right-border">C#</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/developing/erlang/" >
        <span class="block   content-menu__item__right-border">Erlang</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/developing/golang/" >
        <span class="block   content-menu__item__right-border">Go</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/developing/http/" >
        <span class="block   content-menu__item__right-border">HTTP</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/developing/java/" >
        <span class="block   content-menu__item__right-border">Java</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/developing/nodejs/" >
        <span class="block   content-menu__item__right-border">Node.js</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/developing/php/" >
        <span class="block   content-menu__item__right-border">PHP</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/developing/python/" >
        <span class="block   content-menu__item__right-border">Python</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/developing/ruby/" >
        <span class="block   content-menu__item__right-border">Ruby</span>
      </a>

    </div>

  </li>



</ul>

        </li>


        <li >

          <div class="content-menu__item ">

            <span class="block float-left   content-menu__icon-container   docs-icon--tools">|</span>
            <span class="block float-right   content-menu__menu-toggle
                        ">
            </span>

            <a class="block overflow   content-menu__link--depth-0"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/add-ons/" >
              <span class="block   content-menu__item__right-border"><strong>Add-ons</strong></span>
            </a>

          </div>
          
          


<ul class="content-menu
           content-menu--depth-1
           "
    style="display: none">



  <li>

    <div class="content-menu__item ">
      <span class="block float-right   content-menu__menu-toggle
                  ">
      </span>

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/add-ons/spark-riak-connector/" >
        <span class="block   content-menu__item__right-border">Spark-Riak Connector</span>
      </a>

    </div>
    
    


<ul class="content-menu
           content-menu--depth-2
           "
    style="display: none">



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-2"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/add-ons/spark-riak-connector/quick-start/" >
        <span class="block   content-menu__item__right-border">Quick Start Guide</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-2"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/add-ons/spark-riak-connector/getting/" >
        <span class="block   content-menu__item__right-border">Get Spark-Riak Connector</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-2"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/add-ons/spark-riak-connector/building-testing/" >
        <span class="block   content-menu__item__right-border">Building &amp; Testing</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">
      <span class="block float-right   content-menu__menu-toggle
                  ">
      </span>

      <a class="block overflow   content-menu__link--depth-2"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/add-ons/spark-riak-connector/usage/" >
        <span class="block   content-menu__item__right-border">Usage</span>
      </a>

    </div>
    
    


<ul class="content-menu
           content-menu--depth-3
           "
    style="display: none">



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-3"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/add-ons/spark-riak-connector/usage/config-spark-context/" >
        <span class="block   content-menu__item__right-border">Spark Context Configuration</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-3"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/add-ons/spark-riak-connector/usage/reading-data/" >
        <span class="block   content-menu__item__right-border">Reading Data</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-3"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/add-ons/spark-riak-connector/usage/writing-data/" >
        <span class="block   content-menu__item__right-border">Writing Data</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-3"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/add-ons/spark-riak-connector/usage/dataframes/" >
        <span class="block   content-menu__item__right-border">Working With Spark Dataframes</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-3"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/add-ons/spark-riak-connector/usage/dates/" >
        <span class="block   content-menu__item__right-border">Working With TS Dates</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-3"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/add-ons/spark-riak-connector/usage/range-query-partition/" >
        <span class="block   content-menu__item__right-border">TS Table Range Query Partitioning</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-3"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/add-ons/spark-riak-connector/usage/bulk-write/" >
        <span class="block   content-menu__item__right-border">Bulk Write</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-3"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/add-ons/spark-riak-connector/usage/streaming-example/" >
        <span class="block   content-menu__item__right-border">Spark Streaming Example</span>
      </a>

    </div>

  </li>



</ul>

  </li>



</ul>

  </li>



</ul>

        </li>


        <li >

          <div class="content-menu__item ">

            <span class="block float-left   content-menu__icon-container   docs-icon--beaker">|</span>
            <span class="block float-right   content-menu__menu-toggle
                         content-menu__menu-toggle--open ">
            </span>

            <a class="block overflow   content-menu__link--depth-0"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/learn-about/" >
              <span class="block   content-menu__item__right-border"><strong>Learn</strong></span>
            </a>

          </div>
          
          


<ul class="content-menu
           content-menu--depth-1
           content-menu--open"
    style="display: block">



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/learn-about/bestpractices/" >
        <span class="block   content-menu__item__right-border">Best Practices</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item ">

      <a class="block overflow   content-menu__link--depth-1"  href="//evadne.github.io/basho_docs/riak/ts/1.3.1/learn-about/sqlriakts/" >
        <span class="block   content-menu__item__right-border">SQL for Riak TS</span>
      </a>

    </div>

  </li>



  <li>

    <div class="content-menu__item  content-menu__item--selected ">

      <a class="block overflow   content-menu__link--depth-1" >
        <span class="block   content-menu__item__right-border">Table Architecture </span>
      </a>

    </div>

  </li>



</ul>

        </li>

        <li class="content-menu__blank-entry"></li>

      </ul>

    </div>



    <div class="content-nav__fixed-bottom">

      <ul class="content-menu">

        <li>
          <div class="content-menu__item">

            <span class="block float-left   content-menu__icon-container   docs-icon--comments">|</span>

            <a class="block overflow" href="//evadne.github.io/basho_docs/community">
              <span class="block   content-menu__item__right-border">
                <sub>Want some extra help?</sub><br>
                <strong>Ask our Community</strong>
              </span>
            </a>

          </div>
        </li>

        <li>
          <div class="content-menu__item">

            <span class="block float-left   content-menu__icon-container   docs-icon--question-sign">|</span>

            <a class="block overflow" href="http://basho.com/contact">
              <span class="block   content-menu__item__right-border">
                <sub>Need to chat?</sub><br>
                <strong>Contact us directly</strong>
              </span>
            </a>

          </div>
        </li>

        <li>
          <div class="content-menu__item">

            <span class="block float-left   content-menu__icon-container   docs-icon--github-alt">|</span>

            <a class="block overflow" href="https://github.com/basho/basho_docs/edit/master/content/riak/ts/1.3.1/learn-about/tablearchitecture.md">
              <span class="block   content-menu__item__right-border">
                <sub>Noticed a typo?</sub><br>
                <strong>Correct it in GitHub</strong>
              </span>
            </a>

          </div>
        </li>

      </ul>

    </div>

  </div>
  </div>
  </div>



</nav>

<script>
  (function() {
    var cx = '011972015458788978446:zgdcy4fa-o0';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<div style="width:0px;overflow:hidden;height:0px;">
  <gcse:search></gcse:search>
</div>






  <div class="content-well">


    <article class="main-article">


      

<header class="front-matter">


  <h1 class="front-matter__title">

    
    <br>
    Architecture of Riak TS Tables

  </h1>
  <nav class="table-of-contents"></nav>


</header>


      <main>
        

<p>This page provides more in-depth information about how Riak TS tables are structured.</p>

<p>If you just want to get started creating a table in Riak TS, check out our quick guide to <a href="../../using/planning">planning your Riak TS table</a>.</p>

<p>You may also be interested in <a href="../sqlriakts/">more information about SQL in Riak TS</a>.</p>

<h2 id="riak-ts-tables">Riak TS Tables</h2>

<p>With Riak TS, you no longer have to build your own time series database on Riak KV. Instead, Riak TS integrates SQL structure and functionality with Riak KV key/value storage. It does this through Riak TS tables that you customize to fit your time series data and the needs of your workflow.</p>

<h2 id="basic-structure-of-a-riak-ts-table">Basic Structure of a Riak TS Table</h2>

<p>Riak TS enables querying large amounts of related data, so keys behave differently than in Riak KV.</p>

<p>Riak TS has two types of keys:</p>

<ul>
<li><em>partition keys</em>, which determine where the data is placed on the cluster, and</li>
<li><em>local keys</em>, which determine where the data is written in the partition.</li>
</ul>

<p>Partition keys can use <em>time quantization</em> to group data that will be queried together in the same physical part of the cluster. Time quantization says “group data by 15 minute clumps, or 10 second clumps, or 60 day clumps” depending on how quickly your time series data come in and how you need to analyze them. The quantization is configurable on a table level.</p>

<p>In order to query TS data, data is structured using a specific schema. The schema defines what data can be stored in a TS table and what type it has. Queries can then be written against that schema and the TS query system can validate and execute them.</p>

<p>We have combined the definition of the various keys and the data schema into a single SQL-like statement. The query language is a subset of SQL, so you will use the column names and the table name in those queries; SQL conventions such as case sensitivity hold.</p>

<p>Riak TS tables have a one-to-one mapping with Riak KV bucket types.</p>

<h3 id="example">Example</h3>

<pre><code class="language-sql">CREATE TABLE GeoCheckin
(
   region      VARCHAR   NOT NULL,                   -
   state       VARCHAR   NOT NULL,                    |
   time        TIMESTAMP NOT NULL,                    |  --&gt; Column Definitions
   weather     VARCHAR   NOT NULL,                    |
   temperature DOUBLE,                               _
   PRIMARY KEY (
     (region, state, QUANTUM(time, 15, 'm')),        &lt;-- Partition Key
     region, state, time                             &lt;-- Local Key
   )
)
</code></pre>

<h3 id="column-definitions">Column Definitions</h3>

<p>Column definitions are the lines preceding the <code>PRIMARY KEY</code> in the example. Column definitions define the structure of the data. They are comprised of three parts: a column name, a data type, and (optionally) an inline constraint.</p>

<pre><code class="language-sql">column_name data_type [NOT NULL],
</code></pre>

<p>Column names (<code>region</code>, <code>state</code>, etc) must be ASCII strings, in addition to having the correct case. If column names need to contain spaces or punctuation they can be double quoted.</p>

<p>Any column names specified as part of the primary key must be defined as <code>NOT NULL</code>.</p>

<p>The column definitions for the keys can be specified in any order in the <code>CREATE TABLE</code> statement. For instance both are correct:</p>

<p><strong>A.</strong></p>

<pre><code class="language-sql">CREATE TABLE GeoCheckin
(
   region       VARCHAR   NOT NULL,
   state        VARCHAR   NOT NULL,
   time         TIMESTAMP NOT NULL,
   weather      VARCHAR   NOT NULL,
   temperature  DOUBLE,
   PRIMARY KEY (
     (region, state, QUANTUM(time, 15, 'm')),
      region, state, time
   )
)
</code></pre>

<p><strong>B.</strong></p>

<pre><code class="language-sql">CREATE TABLE GeoCheckin
(
   time         TIMESTAMP NOT NULL,
   state        VARCHAR   NOT NULL,
   weather      VARCHAR   NOT NULL,
   region       VARCHAR   NOT NULL,
   temperature  DOUBLE,
   PRIMARY KEY (
     (region, state, QUANTUM(time, 15, 'm')),
      region, state, time
   )
)
</code></pre>

<p>The data types in column definitions are limited. Valid types are:</p>

<ul>
<li><code>VARCHAR</code> - Any string content is valid, including Unicode. Can only be compared using strict equality, and will not be typecast (e.g., to an integer) for comparison purposes. Use single quotes to delimit varchar strings.</li>
<li><code>BOOLEAN</code> - <code>true</code> or <code>false</code> (any case)</li>
<li><code>TIMESTAMP</code> - Timestamps are integer values expressing [UNIX epoch time in UTC][epoch] in milliseconds. Zero is not a valid timestamp.</li>
<li><code>SINT64</code> - Signed 64-bit integer</li>
<li><code>DOUBLE</code> - This type does not comply with its IEEE specification: <code>NaN</code> (not a number) and <code>INF</code> (infinity) cannot be used.</li>
</ul>

<h3 id="primary-key">Primary Key</h3>

<p>The <code>PRIMARY KEY</code> describes both the partition key and local key. The partition key is a prefix of the local key, consisting of one or more column names. The local key must begin with the same column names as the partition key, but may also contain additional column names.</p>

<h4 id="partition-key">Partition Key</h4>

<p>The partition key is the first element of the primary key, and is defined as a list of  column names in parentheses. The partition key must have at least one column name.</p>

<p>If you choose to include a quantum, it will be used to colocate data on one of the partition key&rsquo;s timestamp fields:</p>

<pre><code class="language-sql">PRIMARY KEY  ((region, state, QUANTUM(time, 1, 's')), ...)
</code></pre>

<p>Only one quantum function may be specified and it must be the last element of the partition key.</p>

<p>The quantum function takes 3 parameters:</p>

<ul>
<li>the name of a field in the table definition of type <code>TIMESTAMP</code></li>
<li>a quantity as a positive integer, greater than zero.</li>
<li>a unit of time:

<ul>
<li><code>'d'</code> - days</li>
<li><code>'h'</code> - hours</li>
<li><code>'m'</code> - minutes</li>
<li><code>'s'</code> - seconds</li>
</ul></li>
</ul>

<p>A general guideline to get you started if you are not sure how best to structure your partition key is to first choose a column name that represents a class or type of data, and then choose a  second column name represents is a more specific instance(s) of the class/type.</p>

<h4 id="local-key">Local Key</h4>

<p>The second key (local key) MUST have the same fields in the same order as the partition key. This ensures that the keys are unique for that partition.</p>

<p>It can also have additional fields AFTER the fields in the partition key.</p>

<pre><code class="language-sql">((region, state, QUANTUM(time, 15, 'm')), region, state, time, weather)
</code></pre>

<p>Note that weather is in the local key but not in the partition key.  Fields in the partition key must be covered by a queries where clause, additional fields in the local key do <strong>not</strong> have to be covered.</p>

<h2 id="riak-ts-tables-in-command-line">Riak TS Tables in Command Line</h2>

<p>When you <a href="../../using/creating-activating/">verify that your table was properly created</a>, you&rsquo;ll see a response that shows your table&rsquo;s schema on the command line. It will look something like this:</p>

<pre><code class="language-sh">$ riak-admin bucket-type status GeoCheckin
GeoCheckin is active
...
ddl: {ddl_v1,&lt;&lt;&quot;GeoCheckin&quot;&gt;&gt;,
             [{riak_field_v1,&lt;&lt;&quot;region&quot;&gt;&gt;,1,binary,false},
              {riak_field_v1,&lt;&lt;&quot;state&quot;&gt;&gt;,2,binary,false},
              {riak_field_v1,&lt;&lt;&quot;time&quot;&gt;&gt;,3,timestamp,false},
              {riak_field_v1,&lt;&lt;&quot;weather&quot;&gt;&gt;,4,binary,false},
              {riak_field_v1,&lt;&lt;&quot;temperature&quot;&gt;&gt;,5,double,true}],
             {key_v1,[{hash_fn_v1,riak_ql_quanta,quantum,
                                  {param_v1,[&lt;&lt;&quot;region&quot;&gt;&gt;]},
                      {param_v1,[&lt;&lt;&quot;state&quot;&gt;&gt;]}]},
                      [{param_v1,[&lt;&lt;&quot;time&quot;&gt;&gt;]},15,m],
                                  timestamp},
             {key_v1,[{param_v1,[&lt;&lt;&quot;time&quot;&gt;&gt;]},
                      {param_v1,[&lt;&lt;&quot;region&quot;&gt;&gt;]},
                      {param_v1,[&lt;&lt;&quot;state&quot;&gt;&gt;]}]}}
</code></pre>

<p>The format of the response is:</p>

<pre><code class="language-sh">ddl:  { ddl_v1, TABLE_NAME,
[ ARRAY OF COLUMN DEFINITIONS],
[ KEY INFO ]}}
</code></pre>

<p>The columns definitions are each:</p>

<pre><code class="language-sh">{riak_field_v1,&lt;&lt;&quot;COLUMN_NAME&quot;&gt;&gt;,COLUMN_INDEX,COLUMN_TYPE,NULLABLE}
</code></pre>

<p>The two <code>key_v1</code> entries correspond to the partion key and the local key. The first key contains the column names used for the partition key, which defines how the data set is chunked and where the chunk data is co-located, and the second key contains the local key which uniquely identifies the data within a chunk. These two sets of column names will mostly be the same, but the partition key will have an additional quantum definition for the timestamp and the local key may have additional column names:</p>

<pre><code class="language-sh">{key_v1,[
   {hash_fn_v1,riak_ql_quanta,quantum,
               {param_v1,[&lt;&lt;&quot;region&quot;&gt;&gt;]},                 &lt;- Partition Key Part 1
               {param_v1,[&lt;&lt;&quot;state&quot;&gt;&gt;]},                  &lt;- Partition Key Part 2
               [{param_v1,[&lt;&lt;&quot;time&quot;&gt;&gt;]},15,m],timestamp}  &lt;- Partition Key Part 3

]},
{key_v1,[
   {param_v1,[&lt;&lt;&quot;region&quot;&gt;&gt;]},     &lt;- Local Key part 1
   {param_v1,[&lt;&lt;&quot;state&quot;&gt;&gt;]},      &lt;- Local Key part 2
   {param_v1,[&lt;&lt;&quot;time&quot;&gt;&gt;]}        &lt;- Local Key part 3
   {param_v1,[&lt;&lt;&quot;temperature&quot;&gt;&gt;]} &lt;- Local Key part 4
]}
</code></pre>

<h2 id="data-modeling">Data Modeling</h2>

<pre><code class="language-sql">CREATE TABLE GeoCheckin
(
   region      VARCHAR   NOT NULL,                -
   state       VARCHAR   NOT NULL,                 |
   time        TIMESTAMP NOT NULL,                 |--&gt; Column Definitions
   weather     VARCHAR   NOT NULL,                 |
   temperature DOUBLE,                            _
   PRIMARY KEY (
     (region, state, QUANTUM(time, 15, 'm')),     &lt;-- Partition key
     region, state, time                          &lt;-- Local key
   )
)
</code></pre>

<p>The column names in the partition key are used to determine which vnodes handle the writes and queries, which is why we suggest using a column definition that captures a class or type of data and another that captures an instance of that class or type. For instance, <code>region</code> represents a class of data, whereas <code>state</code> is an instance of that class.</p>

<p>If both column names represent the same class or type of data for large numbers of writes, and the quanta that is specified has a large duration, only n_val vnodes will process the incoming writes. In these instances, Riak will not be able to parallelize the workload across CPUs.</p>

<p>All keys and values are written contiguously on disk. For each co-located block of data a sub-query is created. Currently there is a default maximum of 5 sub-queries per single query to prevent overload; see <a href="../../using/configuring/">Configure Riak TS</a> for details on changing that value.</p>

<p>Choosing a quanta size involves tradeoffs. Small quanta are best for writes while large quanta are best for queries. You should choose your quanta according to your data needs.</p>

<p>It is difficult to make any recommendations on quanta size, because the size of your quanta is heavily dependent on both the kind of data you are gathering and what you need to do with it.</p>

<p>Also see <a href="../bestpractices/">Riak TS Best Practices</a> for more guidance on choosing an appropriate quantum size.</p>

<h2 id="editing-your-table">Editing Your Table</h2>

<p>Once created, you cannot edit your Riak TS table. If you discover something wrong with the setup of your Riak TS table, you will need to create it again. You will also need to decide whether to scrap the data in the existing table or move it from the old table to the new one.</p>

      </main>


    </article>


    <footer class="footer">

  <div class="inline-block   footer__attributions">

    <p>
      This work is licensed under a
      <br class="[bs] hidden-md-up">
      <a href="http://creativecommons.org/licenses/by/4.0/" target="_blank">
        Creative Commons Attribution 4.0 <br class="[bs] hidden-sm-up"> International Public License
      </a>
    </p>

    <p>
      © 2011-2017&nbsp;<a href="http://www.basho.com">Basho Technologies, Inc.</a>
    </p>

  </div>

</footer>



  </div>


  <script src="//evadne.github.io/basho_docs/js/main.js" type="text/javascript"></script>

</body>
</html>
